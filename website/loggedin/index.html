
<style>
        p, p.bold, div.bold, div {
            font-family: arial;
            font-size: 16px;
        }
        .important {
            font-size: 20px;
        }
        table {
          font-family: arial, sans-serif;
          border-collapse: collapse;
        }
        
        td, th {
          border: 1px solid #dddddd;
          text-align: left;
        }
        
        tr:nth-child(even) {
          background-color: #d1d1d1;
        }
        </style>

<script type="text/javascript" src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script type="text/javascript">
    var socket = io.connect('http://192.168.1.12:3000');
    var session_name;

    function requestMusic(data){
        socket.emit('request', { 'body': data, 'client_name': session_name });
    }

    function searchBar() {
        socket.emit('search', { 'body': document.getElementById('SearchBar').value, 'client_name': session_name });
    }

    function firstTime() {
        session_name = document.getElementById('SearchBar').value;
        setName(session_name);
        socket.emit('firstTime', session_name);
    }

    function setName(name) {
        document.getElementById('searchBody').innerHTML = "<input type=\"text\" id=\"SearchBar\" value=\"\"><button id=\"SearchButton\" onclick=\"searchBar();\">Search</button> Requesting under: \'" + name + "\'" + 
                                                            "<table id=\"songTable\">" + 
                                                                "<col width=500>" + 
                                                                "<col width=300>" + 
                                                                "<col width=300>" + 
                                                                "<tr>" + 
                                                                    "<th>Track</th>" + 
                                                                    "<th>Artist</th>" + 
                                                                    "<th>Album</th>" + 
                                                                "</tr>" + 
                                                            "</table>";
        session_name = name;
    }

    socket.on('user', function(data) {
        document.getElementById("login").innerHTML = 'Logged in as: ' + data.body.display_name;
    })

    socket.on('results', function(data) {
        console.log(data);
        var table = document.getElementById('songTable');
        for(var i = table.rows.length - 1; i > 0; i--) table.deleteRow(i);
            data.body.tracks.items.forEach(function(object) {
                var tr = document.createElement('tr');
                tr.innerHTML = '<td>' + object.name + '</td>' +
                '<td>' + object.artists[0].name + '</td>' +
                '<td>' + object.album.name + '</td>' +
                '<button onclick="requestMusic({uri: \'' + object.uri + '\', name: \'' + object.name + '\', artist_name: \'' + object.artists[0].name + '\'});">Request</button>';
                table.appendChild(tr);
            });
        })

    socket.on('playing', function(data) {
        if(data.empty) {
            document.getElementById("nowPlaying").innerHTML = '<b>Now Playing: <span class="important">' + data.body.body.item.name + '</span> by <span class="important">' + data.body.body.item.artists[0].name + '</span></b> (Nothing requested yet)';
        } else if(data.client_name == null) {
            document.getElementById("nowPlaying").innerHTML = '<b>Now Playing: <span class="important">' + data.body.body.item.name + '</span> by <span class="important">' + data.body.body.item.artists[0].name + '</span></b> (Playing suggested songs, request anything to play immediately)';
        } else {
            document.getElementById("nowPlaying").innerHTML = '<b>Now Playing: <span class="important">' + data.body.body.item.name + '</span> by <span class="important">' + data.body.body.item.artists[0].name + '</span></b> (Requested by: \'' + data.client_name + '\')';
        }
        
    })

    socket.on('playlistdata', function(data) {
        console.log(data);
    });

    socket.on('returning_user', function(data) {
        console.log(data);
        setName(data);
    });

        
</script>

<p id='login'>
    Logged in as: 
</p>
<p>
    <div id='nowPlaying'>
        <b>Now Playing: </b>
    </div>
    <div id='queue'>
        <b><u>Queue:</u></b> 
    </div>
</p>
<p id="searchBody" style="font-size:14px">
    <input type="text" id="SearchBar" value=""><button id="SearchButton" onclick="firstTime();">Set Name</button> Set name to request songs
    <table id="songTable">
    </table>
</p>
